@model List<BasicBlogWithAdminPanel.Models.Post>
    @inject Microsoft.AspNetCore.Antiforgery.IAntiforgery Antiforgery
    @{
    ViewData["Title"] = L["AllPostsTitle"];
    var role = ViewData["UserRole"] as string;
    }

    <h2>@L["AllPostsTitle"]</h2>

    <table class="table">
        <thead>
            <tr>
                <th>@L["TitleHeader"]</th>
                <th>@L["AuthorHeader"]</th>
                <th>@L["CreatedAtHeader"]</th>
                @if (role == "Admin")
            {
                <th>@L["ActionsHeader"]</th>
            }
            </tr>
        </thead>
        <tbody>
            @foreach (var post in Model)
        {
            <tr>
                <td>@post.Title</td>
                <td>@post.Author</td>
                <td>@post.CreatedAt.ToString("yyyy-MM-dd HH:mm")</td>
                @if (role == "Admin")
                {
                <form method="post" asp-action="Delete" asp-route-id="@post.Id" style="display:inline;">
                    <input name="__RequestVerificationToken"
                           type="hidden"
                           value="@Antiforgery.GetTokens(Context).RequestToken" />
                    <button type="submit"
                            class="btn btn-link text-danger"
                            title="Delete"
                            onclick="return confirm('@L["DeleteConfirm"]');">
                        ❌
                    </button>
                </form>
                }
            </tr>
        }
        </tbody>
    </table>
